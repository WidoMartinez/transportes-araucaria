# Flujo de GeneraciÃ³n de CÃ³digo de Reserva

## Diagrama de Flujo

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        CLIENTE COMPLETA FORMULARIO                   â”‚
â”‚                    (Flujo Normal o Express)                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚  Frontend envÃ­a datos        â”‚
                  â”‚  POST /enviar-reserva        â”‚
                  â”‚  POST /enviar-reserva-expressâ”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚  Backend: server-db.js       â”‚
                  â”‚                              â”‚
                  â”‚  1. Recibe datos             â”‚
                  â”‚  2. Formatea RUT             â”‚
                  â”‚  3. Genera cÃ³digo Ãºnico â”€â”€â”€â–º â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚  generarCodigoReserva()                      â”‚
          â”‚                                              â”‚
          â”‚  â€¢ Obtiene fecha actual                     â”‚
          â”‚  â€¢ Cuenta reservas del dÃ­a                  â”‚
          â”‚  â€¢ Genera: RES-YYYYMMDD-XXXX               â”‚
          â”‚  â€¢ Verifica unicidad                        â”‚
          â”‚  â€¢ Retorna cÃ³digo                           â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚  Reserva.create()                            â”‚
          â”‚                                              â”‚
          â”‚  {                                           â”‚
          â”‚    codigoReserva: "RES-20251015-0001",     â”‚
          â”‚    nombre: "Juan PÃ©rez",                    â”‚
          â”‚    email: "juan@example.com",               â”‚
          â”‚    ... otros campos                          â”‚
          â”‚  }                                           â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚  Base de Datos MySQL                         â”‚
          â”‚                                              â”‚
          â”‚  INSERT INTO reservas (                      â”‚
          â”‚    codigo_reserva,                           â”‚
          â”‚    nombre,                                   â”‚
          â”‚    email,                                    â”‚
          â”‚    ...                                       â”‚
          â”‚  )                                           â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚  Respuesta JSON al Frontend                  â”‚
          â”‚                                              â”‚
          â”‚  {                                           â”‚
          â”‚    success: true,                            â”‚
          â”‚    reservaId: 123,                           â”‚
          â”‚    codigoReserva: "RES-20251015-0001"       â”‚
          â”‚  }                                           â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚  Frontend: App.jsx                           â”‚
          â”‚                                              â”‚
          â”‚  â€¢ Recibe respuesta                          â”‚
          â”‚  â€¢ Guarda cÃ³digo en estado                   â”‚
          â”‚  â€¢ Muestra diÃ¡logo de confirmaciÃ³n           â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CLIENTE VE CÃ“DIGO DE RESERVA                    â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  âœ… Reserva Enviada                                        â”‚   â”‚
â”‚  â”‚                                                            â”‚   â”‚
â”‚  â”‚  Tu solicitud de reserva ha sido recibida correctamente.  â”‚   â”‚
â”‚  â”‚                                                            â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚   â”‚
â”‚  â”‚  â”‚ CÃ³digo de reserva:                                â”‚    â”‚   â”‚
â”‚  â”‚  â”‚                                                   â”‚    â”‚   â”‚
â”‚  â”‚  â”‚         RES-20251015-0001                         â”‚    â”‚   â”‚
â”‚  â”‚  â”‚                                                   â”‚    â”‚   â”‚
â”‚  â”‚  â”‚ Guarda este cÃ³digo para futuras consultas        â”‚    â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚   â”‚
â”‚  â”‚                                                            â”‚   â”‚
â”‚  â”‚  ğŸ“§ Te hemos enviado un correo de confirmaciÃ³n            â”‚   â”‚
â”‚  â”‚  ğŸ“ Nuestro equipo se pondrÃ¡ en contacto contigo          â”‚   â”‚
â”‚  â”‚                                                            â”‚   â”‚
â”‚  â”‚                    [Entendido]                             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Formato del CÃ³digo

```
RES - 20251015 - 0001
 â”‚      â”‚         â”‚
 â”‚      â”‚         â””â”€â”€ Contador secuencial (4 dÃ­gitos)
 â”‚      â”‚             0001, 0002, 0003...
 â”‚      â”‚
 â”‚      â””â”€â”€ Fecha de creaciÃ³n
 â”‚          YYYYMMDD (aÃ±o, mes, dÃ­a)
 â”‚
 â””â”€â”€ Prefijo que identifica una reserva
```

## Ejemplo de Secuencia Diaria

| Hora    | Reserva | CÃ³digo Generado      |
|---------|---------|----------------------|
| 08:15   | Juan    | RES-20251015-0001   |
| 09:30   | MarÃ­a   | RES-20251015-0002   |
| 10:45   | Pedro   | RES-20251015-0003   |
| 14:20   | Ana     | RES-20251015-0004   |
| ...     | ...     | ...                  |
| 19:50   | Carlos  | RES-20251015-0042   |

Al dÃ­a siguiente, el contador se reinicia:

| Hora    | Reserva | CÃ³digo Generado      |
|---------|---------|----------------------|
| 07:30   | Luis    | RES-20251016-0001   |
| 08:45   | Sofia   | RES-20251016-0002   |

## Puntos Clave

1. **GeneraciÃ³n AutomÃ¡tica**: El cÃ³digo se genera automÃ¡ticamente al crear la reserva
2. **Unicidad Garantizada**: Se verifica en la base de datos que no exista duplicado
3. **Legible**: Formato claro y fÃ¡cil de comunicar
4. **Trazable**: La fecha estÃ¡ incluida en el cÃ³digo
5. **Visible**: Se muestra al cliente inmediatamente despuÃ©s de crear la reserva
6. **Almacenado**: Se guarda en la base de datos con Ã­ndice Ãºnico para bÃºsquedas rÃ¡pidas

## IntegraciÃ³n con Sistemas Existentes

### Correos ElectÃ³nicos
Los correos de notificaciÃ³n pueden incluir el cÃ³digo de reserva para que el cliente lo tenga como referencia.

### Panel de AdministraciÃ³n
El panel puede implementar bÃºsqueda por cÃ³digo de reserva para localizar reservas rÃ¡pidamente.

### Pagos
Al procesar pagos, el cÃ³digo de reserva puede asociarse a la transacciÃ³n para facilitar la conciliaciÃ³n.

### Soporte al Cliente
El equipo de soporte puede solicitar el cÃ³digo al cliente para identificar su reserva de manera eficiente.
